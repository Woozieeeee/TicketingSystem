datasource db {
  provider = "postgresql"
  // If Prisma 7 gives you a 'url' error again, ensure the URL is handled in prisma.config.ts
}

generator client {
  provider = "prisma-client-js"
  output   = "./generated"
}

model User {
  id       String   @id @default(cuid())
  username String   @unique
  password String
  role     String
  dept     String
  // This side is named "UserTickets"
  tickets  Ticket[] @relation("UserTickets")
  // This side is named "AssignedTickets"
  assigned Ticket[] @relation("AssignedTickets")
}

model Ticket {
  id           String   @id @default(cuid())
  title        String
  description  String   @db.Text
  status       Status   @default(PENDING)

  // Relationship 1: The Creator
  userId       String   
  user         User     @relation("UserTickets", fields: [userId], references: [id])

  // Relationship 2: The Assignee
  assignedToId String?  
  assignedTo   User?    @relation("AssignedTickets", fields: [assignedToId], references: [id])

  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

enum Status {
  PENDING
  IN_PROGRESS
  RESOLVED
  CLOSED
} 